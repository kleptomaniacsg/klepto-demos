mappings:
  - source: "customer.name"
    target: "customerName"

  # Outer collection: orders
  - collection:
      source: "orders"
      maxItems: 2
      targetPrefix: "order_"
      itemMappings:
        - source: "orderId"
          targetSuffix: "_id"

        - source: "date"
          targetSuffix: "_date"
          transform:
            name: "formatDate"
            args:
              pattern: "MM/dd/yyyy"

        # Inner collection: items
        - collection:
            source: "items"
            maxItems: 3
            targetPrefix: "order_${index}_item_"
            itemMappings:
              - source: "sku"
                targetSuffix: "_sku"
              - source: "description"
                targetSuffix: "_desc"
                transform: "toUpperCase"
              - source: "price"
                targetSuffix: "_price"
                transform: "formatCurrency"